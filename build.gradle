plugins {
    id 'fabric-loom' version '1.10.5'
    id 'maven-publish'
    id 'com.github.johnrengelman.shadow' version '7.1.2'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

version = project.mod_version
group = project.maven_group

base {
    archivesName = project.archives_base_name
}

repositories {
    mavenCentral()
    flatDir {
        dirs 'libs'
    }
}

dependencies {
    minecraft "com.mojang:minecraft:${minecraft_version}"
    mappings "net.fabricmc:yarn:1.20.4+build.3:v2"
    modImplementation "net.fabricmc:fabric-loader:${loader_version}"
    modImplementation "net.fabricmc.fabric-api:fabric-api:${fabric_version}"

    // MTR local
    implementation(name: 'mtr-4.0.0-prerelease-3', ext: 'jar') {
        transitive = false
    }
}

shadowJar {
    archiveClassifier.set("")
    configurations = [project.configurations.runtimeClasspath]
    relocate 'mtr', 'fr.mtraddon.shadow.mtr'
    zip64 = true
}

remapJar {
    dependsOn shadowJar
    input = shadowJar.archiveFile
}

jar {
    from("LICENSE") {
        rename { "LICENSE_${project.archives_base_name}" }
    }
}